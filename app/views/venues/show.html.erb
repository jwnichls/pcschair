<script>
var venueID = "<%= @venue.id %>";
var adminFlag = false;
var notifyAudio = null;
var timerAudio = null;
var pcsVenueInfo = null;

$(function() {
	notifyAudio = new Audio('/alert.mp3');
	timerAudio = new Audio('/lion.mp3');
	
	connectVolume();
	
	forcePageRefresh(function() {
		forcePapersRefresh(function() {
			setClockSync();
			startTimer();
			startVenueUpdate();
		});
	});
	
	$("#addNewPaper").click(function() {
		var paperId = parseInt($("#newPaperId").val());
		if (Number.isInteger(paperId)) {
			var sendData = { 
					pcs_id : paperId
				};

			$.ajax({
			           type: "POST",
			           url: "/venues/" + venueID + "/addpaper",
			           dataType: "json",
			           success: function() { forcePapersRefresh(); },
			           data: sendData
			       });	
		}
	})
})
</script>

<div class="invisible">
	<span id="pcs2flag"></span>
	<span id="pcs2venueName"></span>
</div>

<p id="notice"><%= notice %></p>

<h1><%= @venue.name %></h1>

<div id="controls">
	Volume: <input id="volumeRange" type="range" min="0.0" max="1.0" step="0.01" value="0.5"/>
</div>

<div id="break" class="row invisible">
	<h2>Currently on Break</h2>
</div>
<div id="main" class="row mainrow rowspace50">
<div class="col-md-4" id="timer">
	0:00
</div>
<div class="col-md-8" id="paper-info">
	<% if @venue.active_paper -%>
		<p class="paper-id"><%= @venue.paper_pcs_id %></p>
		<p class="paper-title"><%= @venue.paper_title %></p>
		<p class="paper-authors"><%= @venue.paper_authors %></p>
	<% else -%>
		<p class="no-active-paper">No Active Paper</p>
	<% end -%>
</div>
</div>
<div class="row rowspace50">
	<div class="cold-md-12">
		<p><b>Upcoming Papers: (<span id="queue-count"><%= @papers.length %></span>)</b></p>
		<ul id="paper-queue">
		<% @papers.each do |paper| -%>
			<li class="paper">
				<% if @venue.pcs2_flag -%>
					<%= link_to paper.pcs_paper_id, "https://new.precisionconference.com/" + @venue.pcs2_venue_name + "/committee/subs/" + paper.pcs_paper_id.to_s %>
				<% else -%>
					<%= paper.pcs_paper_id %>
				<% end -%>
			</li>
		<% end -%>
		</ul>
		<% if @venue.allow_adds -%>
		<p>
			Add A Paper: 
			<input type="text" id="newPaperId"/>
			<button id="addNewPaper">Add</button>
		</p>
		<% end -%>
	</div>
</div>
